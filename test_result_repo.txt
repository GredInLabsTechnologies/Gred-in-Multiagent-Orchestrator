============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-8.4.1, pluggy-1.6.0 -- C:\Users\shilo\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\shilo\Documents\GitHub\Gred-Repo-Orchestrator
plugins: anyio-4.10.0, asyncio-1.1.0, cov-6.2.1
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 6 items

tests/unit/test_repo_service.py::test_list_repos PASSED                  [ 16%]
tests/unit/test_repo_service.py::test_ensure_repo_registry FAILED        [ 33%]
tests/unit/test_repo_service.py::test_vitaminize_repo ERROR              [ 50%]
tests/unit/test_repo_service.py::test_walk_tree PASSED                   [ 66%]
tests/unit/test_repo_service.py::test_perform_search PASSED              [ 83%]
tests/unit/test_repo_service.py::test_search_in_file_error PASSED        [100%]

=================================== ERRORS ====================================
___________________ ERROR at setup of test_vitaminize_repo ____________________
file C:\Users\shilo\Documents\GitHub\Gred-Repo-Orchestrator\tests\unit\test_repo_service.py, line 36
  @patch('tools.repo_orchestrator.services.repo_service.BASE_DIR')
  @patch('tools.repo_orchestrator.services.repo_service.VITAMINIZE_PACKAGE', {"file.py", "dir"})
  def test_vitaminize_repo(mock_vit, mock_base, tmp_path):
E       fixture 'mock_base' not found
>       available fixtures: _class_scoped_runner, _function_scoped_runner, _module_scoped_runner, _package_scoped_runner, _session_scoped_runner, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, clean_environment, cov, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, mock_base_dir, monkeypatch, no_cover, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reset_dependency_overrides, reset_test_state, test_client, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.

C:\Users\shilo\Documents\GitHub\Gred-Repo-Orchestrator\tests\unit\test_repo_service.py:36
================================== FAILURES ===================================
__________________________ test_ensure_repo_registry __________________________

mock_save = <MagicMock name='save_repo_registry' id='2626634811200'>
mock_load = <MagicMock name='load_repo_registry' id='2626631924624'>

    @patch('tools.repo_orchestrator.services.repo_service.load_repo_registry')
    @patch('tools.repo_orchestrator.services.repo_service.save_repo_registry')
    def test_ensure_repo_registry(mock_save, mock_load):
        mock_load.return_value = {"active_repo": "/old/active", "repos": ["/path/old"]}
        repos = [RepoEntry(name="new", path="/path/new")]
    
        registry = RepoService.ensure_repo_registry(repos)
>       assert "/path/new" in registry["repos"]
E       AssertionError: assert '/path/new' in ['/path/old', 'C:\\path\\new']

tests\unit\test_repo_service.py:32: AssertionError
=========================== short test summary info ===========================
FAILED tests/unit/test_repo_service.py::test_ensure_repo_registry - Assertion...
ERROR tests/unit/test_repo_service.py::test_vitaminize_repo
==================== 1 failed, 4 passed, 1 error in 0.45s =====================
